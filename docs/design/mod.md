# 模块
FreeIOT基于“模块”系统构建，这是使用FreeIOT开发物联网产品的最主要的构成元素。

本文假设您对本章介绍的FreeIOT的其他三个要素已有了基本了解，并阅读过[开发者快速指南](../howtouse/developer.md)，了解如何建立产品模型并向其添加模块的流程。如果您还没有阅读过这些，还请您先行了解后再来阅读本文。

## 模块系统中的元素
### 数据点
每个数据点都可按照模块被自定义，通常包括以下字段

|    字段名    | 描述 |
| ---------- | --- |
|  **name** | 数据点名称，将被显示给用户 |
|  **label** | 数据的区分标志 |
|  **format** | 数组，用于描述数据的格式 |
|  **show** | 数组，数据点展示所需变量集，非必要 |
|  **type** | 数据点类型（目前支持number,string，未来将支持更多），非必要 |

其中，区分标志我们建议使用单位或双位的大写英文字母来节省数据传输和存储的成本。由于模块可自定义程度较大，请在使用时参阅各模块的描述文档填写变量，如您想对其定义进一步了解或开发新的模块，请参阅我们开放的代码库中的模块定义文件。

### 数据点分类
在[数据](data.md)一节中介绍过了FreeIOT的三种数据类型，模块定义中仅包括两种：上传量(uplink)、控制量(downlink)，因为反馈量与控制量除了传输方向外定义完全相同。
### 驱动
设备传上来的报文将被驱动解析为数据，目前仅支持simple和json两种报文协议，未来会加入更多报文格式的支持。
#### simple协议
该协议是经过简化的json协议，去除了大括号和双引号的支持，仅将数据报文中的:和,进行解析

例： T:12,H:78.1,S:true,R:abc

该报文将被解析为(Javascript Object伪代码，括号内为类型注释)
```
{
  T: 12,(int)
  H: 78.1,(float)
  S: true,(boolean)
  R: "abc"(string)
}
```

#### json协议
完整的JSON支持，请参阅http://www.json.org

## 模块的构成
FreeIOT中的模块由三个部分组成：
  - 模块元信息（拉取模块列表时可被获取）：声明了模块的基本信息及其所有数据点，以及它们的基本信息及对值的限制。
  - 模块模板（单独拉取模块时获取）：使用mustache模板语言写明的json文件，定义了模块及其数据点，其中包括可按产品需要覆盖的变量。
  - 模块变量集（拉取产品原型时获得）：包括了全部可由产品决定的变量，将被“渲染”到模板中配合元信息使用。

## 模块的使用
模块可被添加到产品原型中，添加过程中需要按相应模块的文档填写自定义的变量值，完成后即可按各模块定义的数据点提交、控制数据即可。

## 当前支持模块列表
<span id="list"></span>
> 最后更新：2017.3.21

|    模块名    | 模块简介 | 当前状态 |
| ---------- | --- |
|  **simple_up** | [标准单点反馈传感器](mods/simple_up.md) | 完整支持 |
|  **simple_down** | [标准单点控制器](mods/simple_down.md) | 完整支持 |
|  **dht11** | [DHT11温湿度传感器](mods/dht11.md) | 完整支持 |
|  **gp2y1010au0f** | [Sharp GP2Y1010AU0F PM2.5灰尘传感器]() | 测试中 |
|  **maxmin_down** | [上下限阈值控制器]() | 测试中 |

如您需要的模块尚未提供支持，请查阅[模块补完计划](../contribute/newmod.md)
